<?xml version="1.0" encoding="UTF-8"?>
<ncx xmlns:ncx="http://www.daisy.org/z3986/2005/ncx/" xmlns="http://www.daisy.org/z3986/2005/ncx/"
    version="2005-1" xml:lang="en">
    <head>
        <meta name="dtb:uid" content="<%= book['uid'] %>"/>
    </head>
    <docTitle>
        <text><%= book['title'] %></text>
    </docTitle>
    <navMap>
    <%- book['outline'].each_with_index do |item, i| -%>
        <navPoint id="#<%= item[2] %>">
            <navLabel>
                <text><%= i+1 -%>. <%= item[1] %></text>
            </navLabel>
            <content src="content.html#<%= item[2] %>"/>
            <%- if item.length > 3
                for j in (3..(item.length - 3)) -%>
            <navPoint id="#<%= item[j][2] %>">
                <navLabel>
                    <text><%= "#{i+1}.#{j-2}" %> <%= item[j][1] %></text>
                </navLabel>
                <content src="content.html#<%= item[j][2] %>"/>
            </navPoint>
            <%- end -%>
            <%- end -%>
        </navPoint>
    <%- end -%>
    </navMap>
</ncx>